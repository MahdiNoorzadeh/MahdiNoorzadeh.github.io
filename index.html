<!DOCTYPE html> 
 <html lang="en"> 
 <head> 
     <meta charset="UTF-8"> 
     <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
     <title>Puja Sridhar // Cogsworth Protocol</title> 
     <script src="https://cdn.tailwindcss.com"></script> 
     <link rel="preconnect" href="https://fonts.googleapis.com"> 
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
     <link href="https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap" rel="stylesheet"> 
     <style> 
         body { 
             font-family: 'Courier Prime', monospace; 
             background-color: #d2d2d2; 
             color: #4a3f36; 
             text-shadow: 0 0 2px rgba(74, 63, 54, 0.3); 
             transition: background-color 0.3s, color 0.3s; 
         } 
         #network-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0.15; } 
         .terminal-container { position: relative; z-index: 3; } 
         #terminal, #gui-mode { 
             position: relative; 
             background-color: #d2d2d2; 
             transition: background-color 0.3s; 
             padding-top: 5rem; /* Added padding for sticky header */ 
         } 
         #terminal { 
             animation: flicker 0.15s infinite; 
             scrollbar-width: none; /* Firefox */ 
         } 
         #terminal::-webkit-scrollbar { 
             display: none; /* Safari and Chrome */ 
         } 
         #scanlines { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 4; pointer-events: none; background: repeating-linear-gradient( 0deg, rgba(0,0,0,0) 0, rgba(0,0,0,0) 2px, rgba(74,63,54,0.1) 3px, rgba(74,63,54,0.1) 4px ); } 
         @keyframes flicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.98; } } 

         #terminal-input { 
             background: transparent; 
             border: none; 
             outline: none; 
             color: #4a3f36; 
             font-family: 'Courier Prime', monospace; 
             caret-color: #4a3f36; 
             word-break: break-all; 
             -webkit-user-modify: read-write-plaintext-only; /* Prevents rich text pasting */ 
             flex-grow: 1; 
         } 
         #terminal-input:focus { 
             outline: none; 
             box-shadow: none; 
         } 
         .prompt-live { 
             color: #665e52; 
             white-space: nowrap; 
         } 

         .command { color: #d9742b; } 
         .link { color: #4a3f36; text-decoration: underline; } 
         .link:hover { color: #28201a; } 
         .ascii-art { 
             white-space: pre; 
             font-family: 'Courier Prime', monospace; 
             line-height: 1.0; 
             font-size: 4px; 
             text-align: center; 
             transform: scaleY(1.1); 
             margin: 2rem 0; 
             margin-top: 0rem; 
         } 
         .ascii-art-bg { 
             display: inline-block; 
             color: #28201a; 
             background-color: #d2d2d2; 
         } 
        #contact-icons-wrapper { 
             position: fixed; 
             top: 1rem; /* Adjusted for body padding */ 
             right: 1rem; /* Adjusted for body padding */ 
             left: 1rem; /* Adjusted for body padding */ 
             z-index: 10; 
             pointer-events: none; 
         } 
         #contact-icons-container { 
             max-width: 44rem; /* max-w-4xl minus padding */ 
             margin: 0 auto; 
             display: flex; 
             justify-content: flex-end; 
         } 
         #contact-icons { 
             display: flex; 
             gap: 0.75rem; 
             pointer-events: auto; 
             align-items: center; 
             padding: 1rem; 
         } 
         #contact-icons a, #contact-icons .icon-button { color: #4a3f36; transition: opacity 0.2s ease-in-out; cursor: pointer; } 
         #contact-icons a:hover, #contact-icons .icon-button:hover { opacity: 0.6; } 
         #contact-icons svg { width: 24px; height: 24px; fill: currentColor; } 

         .output-entry { margin-bottom: 0.75rem; } 
         .skills-category-title { 
             color: #d9742b; 
             margin-bottom: 0.5rem; 
             font-weight: bold; 
             font-size: 1.15em; 
         } 
         .skills-subcategory-title { 
             font-weight: bold; 
             margin-top: 1rem; 
             margin-bottom: 0.5rem; 
         } 
         .skills-grid { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem; } 
         .skill-box { background-color: rgba(74, 63, 54, 0.08); padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.9rem; border: 1px solid rgba(74, 63, 54, 0.15); } 

         #clock { font-size: 0.9rem; opacity: 0.7; } 
         #footer { text-align: center; font-size: 0.8rem; opacity: 0.6; padding-top: 1rem; padding-bottom: 0.5rem; } 

         body.dark { 
             background-color: #282828; 
             color: #ebdbb2; 
             text-shadow: 0 0 2px rgba(235, 219, 178, 0.1); 
         } 
         body.dark #terminal, body.dark #gui-mode { 
             background-color: #282828; 
         } 
         body.dark #terminal-input, 
         body.dark .link, 
         body.dark #contact-icons a, 
         body.dark #contact-icons .icon-button { 
             color: #ebdbb2; 
             caret-color: #ebdbb2; 
         } 
         body.dark .link:hover { 
             color: #d5c4a1; 
         } 
         body.dark .prompt-live { 
             color: #a89984; 
         } 
         body.dark .command, body.dark .skills-category-title { 
              color: #fe8019; 
         } 
         body.dark .skill-box { 
             background-color: rgba(235, 219, 178, 0.05); 
             border-color: rgba(235, 219, 178, 0.1); 
         } 

         #moon-icon { display: none; } 
         body.dark #sun-icon { display: none; } 
         body.dark #moon-icon { display: block; } 

         .prompt-line-wrapper { 
             display: flex; 
             align-items: baseline; 
         } 
         .prompt-line-wrapper > .prompt-live { 
             padding-right: 0.5ch; 
         } 
         .prompt-line-wrapper > #terminal-input { 
             outline: none; 
         } 

         #gui-mode { 
             display: none; 
             background-color: #d2d2d2; 
             transition: background-color 0.3s; 
         } 
         #gui-mode h2 { 
             font-size: 1.5rem; 
             font-weight: bold; 
             color: #d9742b; 
             margin-top: 2rem; 
             margin-bottom: 1rem; 
             border-bottom: 1px solid rgba(74, 63, 54, 0.2); 
             padding-bottom: 0.5rem; 
         } 
         body.dark #gui-mode h2 { 
             color: #fe8019; 
             border-bottom-color: rgba(235, 219, 178, 0.2); 
         } 
         #gui-mode .gui-section { 
             margin-bottom: 2rem; 
         } 
         #gui-mode .gui-item { 
             margin-bottom: 1.5rem; 
         } 
         #gui-mode .gui-item-title { 
             font-weight: bold; 
         } 
         #gui-mode ul { 
             list-style-type: disc; 
             padding-left: 2rem; 
         } 
         #gui-clock { 
             font-size: 0.9rem; 
             opacity: 0.7; 
         } 
         #gui-footer { 
             text-align: center; 
             font-size: 0.8rem; 
             opacity: 0.6; 
             padding-top: 1rem; 
             margin-top: 2rem; 
             border-top: 1px solid rgba(74, 63, 54, 0.2); 
         } 
         body.dark #gui-footer { 
             border-top-color: rgba(235, 219, 178, 0.2); 
         }
         
         .typing-cursor {
             animation: blink 1s step-end infinite;
         }
         @keyframes blink {
             50% { opacity: 0; }
         }
     </style> 
 </head> 
 <body class="p-4 md:p-8"> 

     <canvas id="network-canvas"></canvas> 
     <div id="scanlines"></div> 
     <div id="contact-icons-wrapper"> 
         <div id="contact-icons-container"> 
             <div id="contact-icons"> 
                 <div id="theme-toggle-button" class="icon-button" title="Toggle Theme"> 
                     <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg> 
                     <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg> 
                 </div> 
                 <a href="mailto:pujasridhar28@gmail.com?subject=Connecting%20with%20you%20via%20portfolio&body=Hi%20Puja,%0A%0AI%20came%20across%20your%20portfolio%20and%20wished%20to%20reach%20out.%0A%0APlease%20let%20me%20know%20a%20convenient%20time%20to%20connect.%0A%20Sincerely,%0A%0A[Your%20Name]" title="Email"><svg viewBox="0 0 24 24"><path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0l-8 5l-8-5h16zm0 12H4V8l8 5l8-5v10z"/></svg></a> 
                 <a href="https://www.linkedin.com/in/pujasridhar/" target="_blank" title="LinkedIn"><svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75 .79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a> 
                 <a href="https://github.com/pujasridhar" target="_blank" title="GitHub"><svg viewBox="0 0 25 25"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.09.68-.22.68-.48v-1.7c-2.78.6-3.37-1.34-3.37-1.34-.45-1.15-1.11-1.46-1.11-1.46-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.89 1.53 2.34 1.09 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.95 0-1.09.39-1.98 1.03-2.68-.1-.25-.45-1.27.1-2.65 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.38.2 2.4.1 2.65.64.7 1.03 1.59 1.03 2.68 0 3.85-2.34 4.7-4.57 4.94.36.31.68.92.68 1.85v2.72c0 .27.18.58.69.48A10 10 0 0 0 22 12A10 10 0 0 0 12 2Z"/></svg></a> 
                 <a href="https://drive.google.com/file/d/1XrZ5vb9nad2WnyswQOYPBe3D7speSn6T/view?usp=sharing" target="_blank" title="Resume"> 
                     <svg viewBox="0 0 24 24"> 
                         <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"></path> 
                     </svg> 
                 </a> 
                 <div id="gui-toggle-button" class="icon-button" title="Switch to Standard View"> 
                     <svg id="gui-icon-standard" class="icon-button -ml-1.5" viewBox="0 0 240 330" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet"> 
                       <g stroke="currentColor" stroke-width="20" fill="none" stroke-linecap="round" stroke-linejoin="round"> 
                         <rect x="12" y="12" width="216" height="306" rx="20" ry="20"/> 
                         <circle cx="120" cy="125" r="72"/> 
                         <circle cx="120" cy="105" r="22"/> 
                         <clipPath id="clip-upper" clipPathUnits="userSpaceOnUse"> 
                           <rect x="0" y="0" width="240" height="175"/> 
                         </clipPath> 
                         <g clip-path="url(#clip-upper)"> 
                           <circle cx="120" cy="182" r="49"/> 
                         </g> 
                         <line x1="50" y1="235" x2="106" y2="235"/> 
                         <line x1="134" y1="235" x2="190" y2="235"/> 
                         <line x1="96" y1="270" x2="184" y2="270"/> 
                       </g> 
                     </svg> 
                     <svg id="gui-icon-terminal" style="display: none;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg> 
                 </div> 
             </div> 
         </div> 
     </div> 

     <div class="terminal-container w-full max-w-4xl mx-auto"> 
        <div id="terminal" class="w-full min-h-[95vh] rounded-lg shadow-2xl shadow-stone-500/20 p-4 flex flex-col">
            <div id="status-bar" class="flex items-center gap-4 mb-4">
                <div id="clock"></div>
                <div id="weather-display" class="flex items-center gap-2" title="Your Local Weather">
                    <svg xmlns="http://www.w3.org/2000/svg" 
                        width="24" height="24" 
                        viewBox="0 0 24 24" 
                        fill="currentColor">
                    <path d="M7 17a4 4 0 1 1 0-8
                            5 5 0 0 1 10 0
                            4 4 0 1 1 0 8H7z"/>
                    </svg>
                    <span id="weather-text">--°F</span>
                </div>
            </div>
            <div id="output" class="flex-grow">
                </div>
             <div id="input-line" class="prompt-line-wrapper mt-4 flex-shrink-0"> 
                  <span class="prompt-live text-lg"></span> 
                  <div id="terminal-input" class="text-lg" contenteditable="true" spellcheck="false"></div> 
             </div> 
             <div id="footer"></div> 
         </div> 
         <div id="gui-mode" class="w-full min-h-[95vh] rounded-lg shadow-2xl shadow-stone-500/20 p-8 overflow-y-auto"> 
             <div class="flex justify-start mb-8"> 
                 <div id="gui-clock"></div> 
             </div> 
             <!-- GUI content will be generated here by JS --> 
             <div id="gui-footer"></div> 
         </div> 
     </div> 
     <script type="module">
    import { portfolioData } from './portfolio-data.js';
    function getWeather() {
        const weatherTextEl = document.getElementById('weather-text');
        if (!navigator.geolocation) {
            weatherTextEl.textContent = "N/A";
            return;
        }

        navigator.geolocation.getCurrentPosition(async (position) => {
            try {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit`);
                const data = await response.json();
                const temp = Math.round(data.current_weather.temperature);
                weatherTextEl.textContent = `${temp}°F`;
            } catch (error) {
                console.error("Failed to fetch weather:", error);
                weatherTextEl.textContent = "Error";
            }
        }, () => {
            // This runs if the user denies location permission
            weatherTextEl.textContent = "N/A";
        });
    }
     document.addEventListener('DOMContentLoaded', () => { 
         const outputEl = document.getElementById('output'); 
         const inputEl = document.getElementById('terminal-input'); 
         const terminalEl = document.getElementById('terminal'); 
         const guiModeEl = document.getElementById('gui-mode'); 
         const guiToggleButton = document.getElementById('gui-toggle-button'); 
         const clockEl = document.getElementById('clock'); 
         const guiClockEl = document.getElementById('gui-clock'); 
         const footerEl = document.getElementById('footer'); 
         const guiFooterEl = document.getElementById('gui-footer'); 
         const networkCanvas = document.getElementById('network-canvas'); 
         const networkCtx = networkCanvas.getContext('2d'); 
         const commandHistory = []; 
         let historyIndex = -1; 
         const promptText = 'Cogsworth@linux ~ % '; 
         const livePromptEl = document.querySelector('.prompt-live'); 

         let audioCtx; 
         let soundsReady = false; 
         let documentStore = [];
         let conversationHistory = [];
          
         window.addEventListener('keydown', (e) => { 
             if (e.ctrlKey || e.metaKey || e.altKey || document.activeElement === inputEl) { 
                 return; 
             } 
             inputEl.scrollIntoView({ behavior: 'smooth', block: 'center' }); 
             inputEl.focus(); 
         }); 


         function moveCursorToEnd(el) { 
             const range = document.createRange(); 
             const sel = window.getSelection(); 
             range.selectNodeContents(el); 
             range.collapse(false); 
             sel.removeAllRanges(); 
             sel.addRange(range); 
         } 

        function initAudio() {
            if (soundsReady) return;
            try {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                soundsReady = true;
            } catch (e) {
                console.error("Web Audio API could not be started:", e);
            }
        }
        
        function playSound(frequency, type, duration = 0.08, volume = 0.2) { 
             if (!soundsReady) return; 
             const oscillator = audioCtx.createOscillator(); 
             const gainNode = audioCtx.createGain(); 
             oscillator.connect(gainNode); 
             gainNode.connect(audioCtx.destination); 
             oscillator.type = type; 
             oscillator.frequency.setValueAtTime(frequency, audioCtx.currentTime); 
             gainNode.gain.setValueAtTime(volume, audioCtx.currentTime); 
             gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration); 
             oscillator.start(audioCtx.currentTime); 
             oscillator.stop(audioCtx.currentTime + duration); 
         } 
         function playTypingSound() {
            if (!soundsReady) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            // A high, sharp sound for the "click"
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(1900, audioCtx.currentTime); 
            
            // This creates the sharp "tick" sound
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);

            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.05);
        }

         terminalEl.addEventListener('click', initAudio, { once: true }); 
          
         terminalEl.addEventListener('click', (event) => { 
             if (event.target.tagName.toLowerCase() !== 'a') { 
                 inputEl.focus(); 
             } 
         }); 

         const commands = { 
             'help': showHelp, 'about': showAbout, 'education': showEducation, 'experience': showExperience, 
             'projects': showProjects, 'skills': showSkills, 'languages': showLanguages, 
             'certifications': showCertifications, 'talks': showTalks, 'leadership': showLeadership, 
             'resume': showResume, 'contact': showContact, 'clear': clearTerminal, 
             'all': showAllInfo, 'creator': showCreator 
         }; 

         function appendOutput(html, isCommand = false) { 
             const wrapper = document.createElement('div'); 
             wrapper.className = 'output-entry'; 
             if (isCommand) { 
                 const promptSpan = `<span class="prompt-live text-lg">${promptText.replace(/ /g, '&nbsp;')}</span>`; 
                 const commandSpan = `<span class="command text-lg" style="white-space: pre-wrap; word-break: break-all;">${html}</span>`; 
                 const promptLine = document.createElement('div'); 
                 promptLine.className = 'prompt-line-wrapper'; 
                 promptLine.innerHTML = `${promptSpan}${commandSpan}`; 
                 wrapper.appendChild(promptLine); 
             } else { 
                 wrapper.innerHTML = html.replace(/\n\n/g, '<br><br>').replace(/\n/g, '<br>'); 
             } 
             outputEl.appendChild(wrapper); 
             window.scrollTo(0, document.body.scrollHeight); 
         } 

         function showHelp() { 
             let helpText = `Available commands:<br>  <span class="command">about</span>, <span class="command">education</span>, <span class="command">experience</span>, <span class="command">projects</span>, <span class="command">skills</span>, <span class="command">languages</span>, <span class="command">certifications</span>, <span class="command">talks</span>, <span class="command">leadership</span>, <span class="command">resume</span>, <span class="command">contact</span>, <span class="command">creator</span>, <span class="command">all</span>, <span class="command">clear</span>`; 
             helpText += `<br><br>You can also ask me a question, like: <i>"What are her most recent projects?"</i>`; 
             appendOutput(helpText); 
         } 
         function showAbout() { appendOutput(`<div class="skills-category-title">About Me</div>${portfolioData.about}`); } 
         function showEducation() { 
             let html = '<div class="skills-category-title">Education</div>'; 
             portfolioData.education.forEach(edu => { 
                 html += `<span class="command">${edu.school}</span><br>${edu.degree}<br><i>${edu.details}</i>\n\n`; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showExperience() { 
             let html = '<div class="skills-category-title">Experience</div>'; 
             portfolioData.experience.forEach(e => { 
                 html += `<span class="command">${e.role}</span> @ ${e.company} (${e.period})<br>`; 
                 e.desc.forEach(point => { 
                     html += `- ${point}<br>`; 
                 }); 
                 html += '\n'; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showProjects() { 
             let html = '<div class="skills-category-title">Projects</div>'; 
             portfolioData.projects.forEach(p => { 
                 html += `<span class="command">${p.name}</span><br>  Tech: ${p.tech}<br>`; 
                 p.desc.forEach(point => { 
                     html += `  - ${point}<br>`; 
                 }); 
                 html += `  <a href="${p.url}" target="_blank" class="link">View on GitHub -></a>\n\n`; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showSkills() { 
             let html = '<div class="skills-container">'; 
             html += '<div class="skills-category-title">Skills</div>'; 
             for (const category in portfolioData.skills) { 
                 html += `<div class="skills-subcategory-title">${category}</div>`; 
                 html += '<div class="skills-grid">'; 
                 portfolioData.skills[category].forEach(skill => { 
                     html += `<div class="skill-box">${skill}</div>`; 
                 }); 
                 html += '</div>'; 
             } 
             html += '</div>'; 
             appendOutput(html); 
         } 
         function showLanguages() { 
             let html = '<div class="skills-category-title">Languages</div>'; 
             portfolioData.languages.forEach(lang => { 
                 html += `<span class="command">${lang.lang}:</span> ${lang.proficiency}\n`; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showCertifications() { 
             let html = '<div class="skills-category-title">Certifications</div>'; 
             portfolioData.certifications.forEach(cert => { 
                 const nameSpan = `<span class="command">${cert.name}</span>`; 
                 if (cert.url) { 
                     html += `<a href="${cert.url}" target="_blank" class="link">${nameSpan}</a> - ${cert.issuer}\n\n`; 
                 } else { 
                     html += `${nameSpan} - ${cert.issuer}\n\n`; 
                 } 
             }); 
             appendOutput(html.trim()); 
         } 
         function showTalks() { 
             let html = '<div class="skills-category-title">Talks & Lectures</div>'; 
             portfolioData.talks.forEach(talk => { 
                 html += `<span class="command">"${talk.title}"</span><br><i>Presented at ${talk.venue}, ${talk.date}</i>\n\n`; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showLeadership() { 
             let html = '<div class="skills-category-title">Leadership</div>'; 
             portfolioData.leadership.forEach(role => { 
                 html += `<span class="command">${role.role}</span> | ${role.org} (${role.period})\n`; 
                 role.points.forEach(point => { 
                     html += `- ${point}\n`; 
                 }); 
                 html += '\n'; 
             }); 
             appendOutput(html.trim()); 
         } 
         function showResume() { 
             let html = '<div class="skills-category-title">Resume</div>'; 
             html += `Access my full resume here: <a href="https://drive.google.com/file/d/1XrZ5vb9nad2WnyswQOYPBe3D7speSn6T/view?usp=sharing" target="_blank" class="link">PujaSridhar_Resume.pdf</a>`; 
             appendOutput(html); 
         } 
         function showContact() { 
             let html = '<div class="skills-category-title">Contact</div>'; 
             const prefilledEmail = "mailto:pujasridhar28@gmail.com?subject=Connecting%20with%20you&body=Hi%20Puja,%0A%0AI%20came%20across%20your%20portfolio%20and%20wished%20to%20reach%20out.%0A%0APlease%20let%20me%20know%20a%20convenient%20time%20to%20connect.%0A%0ASincerely,%0A%0A[Your%20Name]"; 
             html += `Email: <a href="${prefilledEmail}" class="link">${portfolioData.contact.email}</a><br>LinkedIn: <a href="${portfolioData.contact.linkedin}" target="_blank" class="link">${portfolioData.contact.linkedin}</a><br>GitHub: <a href="${portfolioData.contact.github}" target="_blank" class="link">${portfolioData.contact.github}</a>`; 
             appendOutput(html); 
         } 
         function showCreator() { appendOutput(`<div class="ascii-art">${portfolioData.creatorArt}</div>`); } 

         function showAllInfo() { 
             const sections = ['about', 'education', 'experience', 'projects', 'skills', 'languages', 'certifications', 'talks', 'leadership', 'resume', 'contact']; 
             let jumpLinks = 'Jump to: '; 
             sections.forEach(sec => { 
                 jumpLinks += `<a href="#${sec}" class="link" onclick="document.getElementById('${sec}').scrollIntoView(); return false;">${sec}</a> | `; 
             }); 
             appendOutput(jumpLinks.slice(0, -2)); 

             sections.forEach(sec => { 
                 const el = document.createElement('div'); 
                 el.id = sec; 
                 outputEl.appendChild(el); 
                 commands[sec](); 
             }); 
         } 

         function clearTerminal() { 
             outputEl.innerHTML = '';
             conversationHistory = [];
             startBootSequence(); 
         } 
         
         

         
        async function getGeminiResponse(userInput) {
            const thinkingMessage = document.createElement('div');
            thinkingMessage.className = 'output-entry';
            thinkingMessage.textContent = 'Cogsworth is thinking...';
            outputEl.appendChild(thinkingMessage);
            window.scrollTo(0, document.body.scrollHeight);

            conversationHistory.push({ role: 'user', text: userInput });

            try {
                const response = await fetch('/api/gemini_call', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: userInput,
                        conversationHistory: conversationHistory.slice(0, -1)
                    })
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

                thinkingMessage.remove();

                // Create a container for the typed-out response
                const responseEntry = document.createElement('div');
                responseEntry.className = 'output-entry';
                
                // This span will hold the text as it's typed
                const responseTextSpan = document.createElement('span');
                
                // This is the blinking cursor at the end
                const cursor = document.createElement('span');
                cursor.className = 'typing-cursor';
                cursor.innerHTML = '&#9646;';

                responseEntry.appendChild(responseTextSpan);
                responseEntry.appendChild(cursor);
                outputEl.appendChild(responseEntry);

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let fullResponseText = "";

                while (true) {
                    const { value, done } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value, { stream: true });
                    fullResponseText += chunk;

                    // NEW: Loop through each character in the chunk for the typing effect
                    for (const char of chunk) {
                        // Parse markdown as we type
                        const formattedChar = parseMarkdown(char);
                        responseTextSpan.innerHTML += formattedChar;
                        
                        // Play the typing sound for non-whitespace characters
                        if (char.trim() !== '') {
                            playTypingSound();
                        }

                        window.scrollTo(0, document.body.scrollHeight);
                        // Wait for a short moment to simulate typing speed
                        await new Promise(resolve => setTimeout(resolve, 20)); 
                    }
                }
                
                cursor.remove(); // Remove the cursor when typing is complete
                
                // Add the final, complete response to our history for the next turn
                conversationHistory.push({ role: 'assistant', text: fullResponseText });

            } catch (error) {
                if (thinkingMessage) thinkingMessage.remove();
                appendOutput("<span class='error'>Error: Could not connect to the AI assistant.</span>");
                console.error("AI Fetch Error:", error);
            }
        }

         function parseMarkdown(text) { return text.replace(/\*\*(.*?)\*\*/g, '<span class="command">$1</span>').replace(/\*(.*?)\*/g, '<i>$1</i>').replace(/\n/g, '<br>'); } 

         inputEl.addEventListener('keydown', (e) => { 
             if (!soundsReady) {
                 initAudio();
             }
              if (e.key === 'Tab') { 
                 e.preventDefault(); 
                 const currentInput = inputEl.textContent.trim(); 
                 const potentialCommands = Object.keys(commands).filter(cmd => cmd.startsWith(currentInput)); 
                 if (potentialCommands.length > 0) { 
                     inputEl.textContent = potentialCommands[0]; 
                     moveCursorToEnd(inputEl); 
                 } 
             } else if (e.key === 'Enter' && !e.shiftKey) { 
                 e.preventDefault(); 
                 playSound(440, 'square', 0.08, 0.2); 
                 const userInput = inputEl.innerText.trim(); 
                 if (!userInput) return; 
                 appendOutput(userInput, true); 
                 if (commands[userInput.toLowerCase()]) { 
                     commands[userInput.toLowerCase()](); 
                 } else { 
                     getGeminiResponse(userInput); 
                 } 
                 commandHistory.unshift(userInput); 
                 historyIndex = -1; 
                 inputEl.textContent = ''; 
             } else if (e.key === 'ArrowUp') { 
                 e.preventDefault(); 
                 if (historyIndex < commandHistory.length - 1) { 
                     historyIndex++; 
                     inputEl.textContent = commandHistory[historyIndex]; 
                     moveCursorToEnd(inputEl); 
                 } 
             } else if (e.key === 'ArrowDown') { 
                 e.preventDefault(); 
                 if (historyIndex > 0) { 
                     historyIndex--; 
                     inputEl.textContent = commandHistory[historyIndex]; 
                     moveCursorToEnd(inputEl); 
                 } else { 
                     historyIndex = -1; 
                     inputEl.textContent = ''; 
                 } 
             } else { 
                 playSound(880, 'sine', 0.08, 0.2);
             } 
         }); 

         function startBootSequence() { 
             const bootText = `Initializing Cogsworth v1.0...\nChanneling legacy of Babbage, Lovelace, Turing... OK.\nParsing lineage of data... OK.\nProtocol established. Welcome.\n\nI am Cogsworth, an AI built to present the work of Puja Sridhar.\nType <span class="command">'help'</span> for a list of commands, or ask me a question in plain English.`; 
             appendOutput(bootText, false); 
             inputEl.focus(); 
         } 

         function updateClock() { 
             const timeString = new Date().toLocaleTimeString(); 
             clockEl.textContent = timeString; 
             if (guiClockEl) guiClockEl.textContent = timeString; 
         } 
          
         const copyrightText = `&copy; ${new Date().getFullYear()} Puja Sridhar. All rights reserved. | <a href="https://drive.google.com/file/d/1XrZ5vb9nad2WnyswQOYPBe3D7speSn6T/view?usp=sharing" target="_blank" class="link">View Resume</a>`; 
         footerEl.innerHTML = copyrightText; 

         const guiFooterText = `&copy; ${new Date().getFullYear()} Puja Sridhar. All rights reserved. | <a href="https://drive.google.com/file/d/1XrZ5vb9nad2WnyswQOYPBe3D7speSn6T/view?usp=sharing" target="_blank" class="link">View Full Resume</a>`; 
         if (guiFooterEl) guiFooterEl.innerHTML = guiFooterText; 

         setInterval(updateClock, 1000); 
         updateClock(); 

         const darkModeToggle = document.getElementById('theme-toggle-button'); 
         let networkColor = "74, 63, 54"; 

         function setDarkMode(isDark) { 
             if (isDark) { 
                 document.body.classList.add('dark'); 
                 networkColor = "235, 219, 178"; 
             } else { 
                 document.body.classList.remove('dark'); 
                 networkColor = "74, 63, 54"; 
             } 
         } 

         darkModeToggle.addEventListener('click', () => { 
             const isDark = document.body.classList.toggle('dark'); 
             localStorage.setItem('darkMode', isDark); 
             setDarkMode(isDark); 
         }); 

         if (localStorage.getItem('darkMode') === 'true') { 
             setDarkMode(true); 
         } 

         livePromptEl.innerHTML = promptText.replace(/ /g, '&nbsp;'); 

         function generateGuiContent() { 
             const guiContentContainer = document.createElement('div'); 
             let html = ``; 
             html += `<div class="gui-section"><h2>About Me</h2><p>${portfolioData.about.replace(/\n/g, '<br>')}</p></div>`; 
             html += `<div class="gui-section"><h2>Experience</h2>`; 
             portfolioData.experience.forEach(e => { 
                 html += `<div class="gui-item"><div class="gui-item-title">${e.role} @ ${e.company} (${e.period})</div><ul>`; 
                 e.desc.forEach(p => { html += `<li>${p}</li>`; }); 
                 html += `</ul></div>`; 
             }); 
             html += `</div>`; 
             html += `<div class="gui-section"><h2>Projects</h2>`; 
             portfolioData.projects.forEach(p => { 
                 html += `<div class="gui-item"><div class="gui-item-title">${p.name} (<span class="text-sm">${p.tech}</span>)</div><ul>`; 
                 p.desc.forEach(d => { html += `<li>${d}</li>`; }); 
                 html += `</ul><a href="${p.url}" target="_blank" class="link">View on GitHub -></a></div>`; 
             }); 
             html += `</div>`; 
             html += `<div class="gui-section"><h2>Skills</h2>`; 
             for (const category in portfolioData.skills) { 
                 html += `<div class="skills-subcategory-title">${category}</div>`; 
                 html += '<div class="skills-grid">'; 
                 portfolioData.skills[category].forEach(skill => { 
                     html += `<div class="skill-box">${skill}</div>`; 
                 }); 
                 html += '</div>'; 
             } 
             html += '</div>'; 
             guiContentContainer.innerHTML = html; 
              
             const oldContent = guiModeEl.querySelector('.gui-content-wrapper'); 
             if(oldContent) oldContent.remove(); 

             guiContentContainer.className = 'gui-content-wrapper'; 
             guiModeEl.insertBefore(guiContentContainer, guiFooterEl); 
         } 

         const guiIconStandard = document.getElementById('gui-icon-standard'); 
         const guiIconTerminal = document.getElementById('gui-icon-terminal'); 

         guiToggleButton.addEventListener('click', () => { 
             const isTerminalVisible = terminalEl.style.display !== 'none'; 
             if (isTerminalVisible) { 
                 terminalEl.style.display = 'none'; 
                 guiModeEl.style.display = 'block'; 
                 guiToggleButton.title = "Switch to Terminal View"; 
                 guiIconStandard.style.display = 'none'; 
                 guiIconTerminal.style.display = 'block'; 
                 generateGuiContent(); 
             } else { 
                 terminalEl.style.display = 'flex'; 
                 guiModeEl.style.display = 'none'; 
                 guiToggleButton.title = "Switch to Standard View"; 
                 guiIconStandard.style.display = 'block'; 
                 guiIconTerminal.style.display = 'none'; 
             } 
         }); 


         const mouse = { x: undefined, y: undefined }; 
         window.addEventListener('mousemove', (event) => { mouse.x = event.x; mouse.y = event.y; }); 
         let nodes = []; 
         const nodeCount = Math.floor((window.innerWidth * window.innerHeight) / 25000); 
         function resizeCanvas() { networkCanvas.width = window.innerWidth; networkCanvas.height = window.innerHeight; } 
         function setupNetwork() { 
             nodes = []; 
             for (let i = 0; i < nodeCount; i++) { 
                 nodes.push({ x: Math.random() * networkCanvas.width, y: Math.random() * networkCanvas.height, vx: (Math.random() - 0.5) * 0.3, vy: (Math.random() - 0.5) * 0.3, radius: Math.random() * 1.5 + 1 }); 
             } 
         } 
         function drawNetwork() { 
             networkCtx.clearRect(0, 0, networkCanvas.width, networkCanvas.height); 
             const interactionRadius = 150; 
             nodes.forEach(node => { 
                 node.x += node.vx; node.y += node.vy; 
                 if (node.x < 0 || node.x > networkCanvas.width) node.vx *= -1; 
                 if (node.y < 0 || node.y > networkCanvas.height) node.vy *= -1; 
                 let mouseDistance = mouse.x === undefined ? Infinity : Math.hypot(node.x - mouse.x, node.y - mouse.y); 
                 const opacity = Math.max(0, 1 - mouseDistance / interactionRadius); 
                 networkCtx.beginPath(); 
                 networkCtx.arc(node.x, node.y, node.radius, 0, Math.PI * 2); 
                 networkCtx.fillStyle = `rgba(${networkColor}, ${0.5 + opacity * 0.5})`; 
                 networkCtx.fill(); 
             }); 
             for (let i = 0; i < nodes.length; i++) { 
                 for (let j = i + 1; j < nodes.length; j++) { 
                     const dist = Math.hypot(nodes[i].x - nodes[j].x, nodes[j].y - nodes[j].y); 
                     if (dist < 120) { 
                         const mouseDistance = mouse.x === undefined ? Infinity : Math.hypot(((nodes[i].x + nodes[j].x) / 2) - mouse.x, ((nodes[i].y + nodes[j].y) / 2) - mouse.y); 
                         const opacity = Math.max(0.1, 1 - mouseDistance / interactionRadius); 
                         networkCtx.beginPath(); 
                         networkCtx.moveTo(nodes[i].x, nodes[i].y); 
                         networkCtx.lineTo(nodes[j].x, nodes[j].y); 
                         networkCtx.strokeStyle = `rgba(${networkColor}, ${(1 - dist / 120) * 0.5 * opacity})`; 
                         networkCtx.stroke(); 
                     } 
                 } 
             } 
         } 
         function animate() { drawNetwork(); requestAnimationFrame(animate); } 

         window.addEventListener('resize', () => { 
             resizeCanvas(); 
             setupNetwork(); 
         }); 

         resizeCanvas(); 
         setupNetwork(); 
         animate(); 
         getWeather();
         startBootSequence(); 
     }); 
     </script> 
      
 </body> 
 </html>

